<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>3D Proposal üíç</title>

<style>
html,body{
  margin:0;
  padding:0;
  overflow:hidden;
  background:black;
  font-family:sans-serif;
}
#ui{
  position:fixed;
  bottom:30px;
  width:100%;
  text-align:center;
  z-index:10;
}
button{
  padding:14px 30px;
  font-size:18px;
  border-radius:30px;
  border:none;
  margin:10px;
}
</style>
</head>

<body>

<div id="ui">
  <button id="yes">YES ‚ù§Ô∏è</button>
  <button id="no">NO</button>
</div>

<!-- THREE CORE -->
<script src="https://unpkg.com/three@0.158.0/build/three.min.js"></script>
<script src="https://unpkg.com/three@0.158.0/examples/js/loaders/GLTFLoader.js"></script>

<script>
/* ================= SCENE ================= */
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x000000);

/* ================= CAMERA ================= */
const camera = new THREE.PerspectiveCamera(
  55,
  window.innerWidth / window.innerHeight,
  0.1,
  100
);
camera.position.set(0,1.6,5);

/* ================= RENDERER ================= */
const renderer = new THREE.WebGLRenderer({ antialias:true });
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setPixelRatio(window.devicePixelRatio);
document.body.appendChild(renderer.domElement);

/* ================= LIGHTS ================= */
scene.add(new THREE.AmbientLight(0xffffff,0.7));

const dirLight = new THREE.DirectionalLight(0xffffff,1.2);
dirLight.position.set(5,10,5);
scene.add(dirLight);

/* ================= FLOOR ================= */
const floor = new THREE.Mesh(
  new THREE.PlaneGeometry(30,30),
  new THREE.MeshStandardMaterial({color:0x111111})
);
floor.rotation.x = -Math.PI/2;
floor.position.y = -1;
scene.add(floor);

/* ================= MODELS ================= */
const loader = new THREE.GLTFLoader();

let boy, girl;

/* BOY MODEL */
loader.load(
  "https://modelviewer.dev/shared-assets/models/Astronaut.glb",
  gltf=>{
    boy = gltf.scene;
    boy.scale.set(1.2,1.2,1.2);
    boy.position.set(-1,-1,0);
    scene.add(boy);
  }
);

/* GIRL MODEL */
loader.load(
  "https://modelviewer.dev/shared-assets/models/RobotExpressive.glb",
  gltf=>{
    girl = gltf.scene;
    girl.scale.set(0.8,0.8,0.8);
    girl.position.set(1,-1,0);
    scene.add(girl);
  }
);

/* ================= RING ================= */
const ring = new THREE.Mesh(
  new THREE.TorusGeometry(0.25,0.06,32,100),
  new THREE.MeshStandardMaterial({
    color:0xffd700,
    metalness:1,
    roughness:0.2
  })
);
ring.position.set(0,1.5,-4);
scene.add(ring);

/* ================= FLOWERS ================= */
const flowers=[];
const flowerGeo = new THREE.SphereGeometry(0.05,8,8);
const flowerMat = new THREE.MeshStandardMaterial({color:0xffb7c5});

/* ================= STATE ================= */
let accepted=false;
let ringFlying=true;

/* ================= ANIMATE ================= */
function animate(){
  requestAnimationFrame(animate);

  ring.rotation.y += 0.03;

  if(ringFlying && ring.position.z < -0.3){
    ring.position.z += 0.05;
  }

  flowers.forEach(f=>f.position.y -= 0.03);

  renderer.render(scene,camera);
}
animate();

/* ================= RESIZE ================= */
window.addEventListener("resize",()=>{
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth,window.innerHeight);
});

/* ================= UI ================= */
document.getElementById("no").onclick=()=>{
  alert("No is not allowed üòå");
};

document.getElementById("yes").onclick=()=>{
  if(accepted) return;
  accepted=true;

  // Boy kneels
  if(boy) boy.position.y = -1.4;

  // Ring to girl
  ringFlying=false;
  ring.position.set(1,0.8,0);

  // Hug
  setTimeout(()=>{
    if(boy) boy.position.x = -0.2;
    if(girl) girl.position.x = 0.2;
  },900);

  // Flowers
  setTimeout(()=>{
    for(let i=0;i<70;i++){
      const fl = new THREE.Mesh(flowerGeo,flowerMat);
      fl.position.set(
        (Math.random()*6)-3,
        5+Math.random()*2,
        Math.random()*2
      );
      flowers.push(fl);
      scene.add(fl);
    }
  },1300);

  // Final message
  setTimeout(()=>{
    alert("Thanks for choosing me ‚ù§Ô∏è I love you so much jaanu");
  },2600);
};
</script>

</body>
</html>
